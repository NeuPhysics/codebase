(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     27421,        851]
NotebookOptionsPosition[     26183,        802]
NotebookOutlinePosition[     26577,        819]
CellTagsIndexPosition[     26534,        816]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"eqn", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"f", "[", "x", "]"}], ",", "x"}], "]"}], ",", "x"}], "]"}], 
    "-", 
    RowBox[{
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"a", " ", "k", " ", 
        RowBox[{"Cot", "[", 
         RowBox[{"k", " ", "x"}], "]"}]}], "+", 
       RowBox[{"i", 
        RowBox[{"(", 
         RowBox[{"omegam", " ", "-", " ", 
          RowBox[{"a", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"k", " ", "x"}], "]"}], 
           RowBox[{"Cos", "[", 
            RowBox[{"2", "thetam"}], "]"}]}]}], ")"}], " ", "a", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"k", " ", "x"}], "]"}]}]}], " ", ")"}], 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"f", "[", "x", "]"}], ",", "x"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "thetam"}], "]"}], "/", "2"}], ")"}], "^", "2"}], 
     " ", 
     RowBox[{"a", "^", "2"}], " ", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"k", " ", "x"}], "]"}], "^", "2"}], " ", 
     RowBox[{"f", "[", "x", "]"}]}]}], "\[Equal]", "0"}]}]], "Input",
 CellChangeTimes->{{3.6626719930626593`*^9, 3.6626720468343353`*^9}, {
  3.6626720781545677`*^9, 3.6626721992058573`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["a", "2"], " ", 
    RowBox[{"f", "[", "x", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "thetam"}], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", 
      RowBox[{"k", " ", "x"}], "]"}], "2"]}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", " ", "k", " ", 
       RowBox[{"Cot", "[", 
        RowBox[{"k", " ", "x"}], "]"}]}], "+", 
      RowBox[{"a", " ", "i", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"k", " ", "x"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"omegam", "-", 
         RowBox[{"a", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "thetam"}], "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"k", " ", "x"}], "]"}]}]}], ")"}]}]}], ")"}], " ", 
    RowBox[{
     SuperscriptBox["f", "\[Prime]",
      MultilineFunction->None], "[", "x", "]"}]}], "+", 
   RowBox[{
    SuperscriptBox["f", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "x", "]"}]}], "\[Equal]", "0"}]], "Output",\

 CellChangeTimes->{{3.6626721601484327`*^9, 3.662672165589202*^9}, 
   3.6626722027512903`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{"eqn", ",", 
   RowBox[{"f", "[", "x", "]"}], ",", "x"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      FractionBox["1", "4"], " ", 
      SuperscriptBox["a", "2"], " ", 
      RowBox[{"f", "[", "x", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "thetam"}], "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", 
        RowBox[{"k", " ", "x"}], "]"}], "2"]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", " ", "k", " ", 
         RowBox[{"Cot", "[", 
          RowBox[{"k", " ", "x"}], "]"}]}], "+", 
        RowBox[{"a", " ", "i", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"k", " ", "x"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"omegam", "-", 
           RowBox[{"a", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "thetam"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"k", " ", "x"}], "]"}]}]}], ")"}]}]}], ")"}], " ", 
      RowBox[{
       SuperscriptBox["f", "\[Prime]",
        MultilineFunction->None], "[", "x", "]"}]}], "+", 
     RowBox[{
      SuperscriptBox["f", "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "x", "]"}]}], "\[Equal]", "0"}], ",", 
   RowBox[{"f", "[", "x", "]"}], ",", "x"}], "]"}]], "Output",
 CellChangeTimes->{3.662672230800395*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", "x", "]"}], "+", 
     RowBox[{"x", " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"f", "[", "x", "]"}], ",", "x"}], "]"}]}]}], "\[Equal]", 
    RowBox[{
     RowBox[{"omegam", "/", "2"}], "-", 
     RowBox[{
      RowBox[{"deltalambda", "[", "x", "]"}], 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"2", "thetam"}], "]"}], "/", "2"}]}]}]}], ",", 
   RowBox[{"f", "[", "x", "]"}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.6628180661257133`*^9, 3.662818097767128*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"f", "[", "x", "]"}], "\[Rule]", 
    RowBox[{
     FractionBox[
      RowBox[{"C", "[", "1", "]"}], "x"], "+", 
     FractionBox[
      RowBox[{
       SubsuperscriptBox["\[Integral]", "1", "x"], 
       RowBox[{
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"omegam", "-", 
           RowBox[{
            RowBox[{"deltalambda", "[", 
             RowBox[{"K", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", "thetam"}], "]"}]}]}], ")"}]}], 
        RowBox[{"\[DifferentialD]", 
         RowBox[{"K", "[", "1", "]"}]}]}]}], "x"]}]}], "}"}], "}"}]], "Output",\

 CellChangeTimes->{3.662818105533119*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sys", "=", 
  RowBox[{
   RowBox[{"I", " ", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"phi1", "[", "x", "]"}], ",", 
        RowBox[{"phi2", "[", "x", "]"}]}], "}"}], ",", "x"}], "]"}]}], 
   "\[Equal]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"g0R", "+", 
           RowBox[{"I", " ", "g0I"}]}], ")"}], " ", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "omegam"}], "+", 
             RowBox[{"n0", " ", "k"}]}], ")"}], "x"}], "]"}]}]}], "}"}], ",", 
      
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"g0R", "-", 
           RowBox[{"I", " ", "g0I"}]}], ")"}], " ", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "I"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "omegam"}], "+", 
             RowBox[{"n0", " ", "k"}]}], ")"}], "x"}], "]"}]}], ",", "0"}], 
       "}"}]}], "}"}], ".", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"phi1", "[", "x", "]"}], ",", 
      RowBox[{"phi2", "[", "x", "]"}]}], "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.662958907001377*^9, 3.66295892756066*^9}, {
  3.662958969235578*^9, 3.6629589991603003`*^9}, {3.6629590342539*^9, 
  3.662959062327342*^9}, {3.6629591195238247`*^9, 3.6629591690016947`*^9}, {
  3.6629592219339*^9, 3.662959229288431*^9}, {3.663434404042448*^9, 
  3.6634344129750233`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{
      SuperscriptBox["phi1", "\[Prime]",
       MultilineFunction->None], "[", "x", "]"}]}], ",", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{
      SuperscriptBox["phi2", "\[Prime]",
       MultilineFunction->None], "[", "x", "]"}]}]}], "}"}], "\[Equal]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"k", " ", "n0"}], "-", "omegam"}], ")"}], " ", "x"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", "g0I"}], "+", "g0R"}], ")"}], " ", 
     RowBox[{"phi2", "[", "x", "]"}]}], ",", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"k", " ", "n0"}], "-", "omegam"}], ")"}], " ", "x"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "g0I"}], "+", "g0R"}], ")"}], 
     " ", 
     RowBox[{"phi1", "[", "x", "]"}]}]}], "}"}]}]], "Output",
 CellChangeTimes->{3.662959231550256*^9, 3.663434420612898*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{"sys", ",", 
   RowBox[{"{", 
    RowBox[{"phi1", ",", "phi2"}], "}"}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.662959233473789*^9, 3.662959238506991*^9}, {
  3.6629636286529427`*^9, 3.662963633298894*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"phi1", "\[Rule]", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"k", " ", "n0"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              SqrtBox[
               RowBox[{
                RowBox[{
                 RowBox[{"-", "4"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["g0I", "2"], "+", 
                   SuperscriptBox["g0R", "2"]}], ")"}]}], "-", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"k", " ", "n0"}], "-", "omegam"}], ")"}], 
                 "2"]}]]}], "-", "omegam"}], ")"}], " ", "x"}]], " ", 
         RowBox[{"C", "[", "1", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SqrtBox[
              RowBox[{
               RowBox[{
                RowBox[{"-", "4"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["g0I", "2"], "+", 
                  SuperscriptBox["g0R", "2"]}], ")"}]}], "-", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"k", " ", "n0"}], "-", "omegam"}], ")"}], "2"]}]], 
             "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"k", " ", "n0"}], "-", "omegam"}], ")"}]}]}], ")"}], 
           " ", "x"}]], " ", 
         RowBox[{"C", "[", "2", "]"}]}]}]}], "]"}]}], ",", 
    RowBox[{"phi2", "\[Rule]", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", 
       RowBox[{
        RowBox[{
         FractionBox["1", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"g0I", "-", 
             RowBox[{"\[ImaginaryI]", " ", "g0R"}]}], ")"}]}]], 
         RowBox[{"\[ImaginaryI]", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"k", " ", "n0"}], "-", "omegam"}], ")"}], " ", "x"}], 
            "+", 
            RowBox[{
             FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"k", " ", "n0"}], "+", 
               RowBox[{"\[ImaginaryI]", " ", 
                SqrtBox[
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "4"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["g0I", "2"], "+", 
                    SuperscriptBox["g0R", "2"]}], ")"}]}], "-", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"k", " ", "n0"}], "-", "omegam"}], ")"}], 
                   "2"]}]]}], "-", "omegam"}], ")"}], " ", "x"}]}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k", " ", "n0"}], "+", 
            RowBox[{"\[ImaginaryI]", " ", 
             SqrtBox[
              RowBox[{
               RowBox[{
                RowBox[{"-", "4"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["g0I", "2"], "+", 
                  SuperscriptBox["g0R", "2"]}], ")"}]}], "-", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"k", " ", "n0"}], "-", "omegam"}], ")"}], "2"]}]]}],
             "-", "omegam"}], ")"}], " ", 
          RowBox[{"C", "[", "1", "]"}]}]}], "+", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"g0I", "-", 
             RowBox[{"\[ImaginaryI]", " ", "g0R"}]}], ")"}]}]], 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SqrtBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "4"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["g0I", "2"], "+", 
                    SuperscriptBox["g0R", "2"]}], ")"}]}], "-", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"k", " ", "n0"}], "-", "omegam"}], ")"}], "2"]}]],
                "+", 
               RowBox[{"\[ImaginaryI]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"k", " ", "n0"}], "-", "omegam"}], ")"}]}]}], ")"}],
              " ", "x"}], "-", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"k", " ", "n0"}], "-", "omegam"}], ")"}], " ", 
             "x"}]}]], " ", 
          RowBox[{"(", 
           RowBox[{
            SqrtBox[
             RowBox[{
              RowBox[{
               RowBox[{"-", "4"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["g0I", "2"], "+", 
                 SuperscriptBox["g0R", "2"]}], ")"}]}], "-", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"k", " ", "n0"}], "-", "omegam"}], ")"}], "2"]}]], 
            "+", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"k", " ", "n0"}], "-", "omegam"}], ")"}]}]}], ")"}], 
          " ", 
          RowBox[{"C", "[", "2", "]"}]}]}]}]}], "]"}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.662963634775683*^9, 3.663434425093546*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.662964164494339*^9, 3.662964167081634*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"phi1", "\[Rule]", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"k", " ", "n0"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              SqrtBox[
               RowBox[{
                RowBox[{
                 RowBox[{"-", "4"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["g0I", "2"], "+", 
                   SuperscriptBox["g0R", "2"]}], ")"}]}], "-", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"k", " ", "n0"}], "-", "omegam"}], ")"}], 
                 "2"]}]]}], "-", "omegam"}], ")"}], " ", "x"}]], " ", 
         RowBox[{"C", "[", "1", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SqrtBox[
              RowBox[{
               RowBox[{
                RowBox[{"-", "4"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["g0I", "2"], "+", 
                  SuperscriptBox["g0R", "2"]}], ")"}]}], "-", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"k", " ", "n0"}], "-", "omegam"}], ")"}], "2"]}]], 
             "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"k", " ", "n0"}], "-", "omegam"}], ")"}]}]}], ")"}], 
           " ", "x"}]], " ", 
         RowBox[{"C", "[", "2", "]"}]}]}]}], "]"}]}], ",", 
    RowBox[{"phi2", "\[Rule]", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", 
       RowBox[{
        RowBox[{
         FractionBox["1", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"g0I", "-", 
             RowBox[{"\[ImaginaryI]", " ", "g0R"}]}], ")"}]}]], 
         RowBox[{"\[ImaginaryI]", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"k", " ", "n0"}], "-", "omegam"}], ")"}], " ", "x"}], 
            "+", 
            RowBox[{
             FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"k", " ", "n0"}], "+", 
               RowBox[{"\[ImaginaryI]", " ", 
                SqrtBox[
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "4"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["g0I", "2"], "+", 
                    SuperscriptBox["g0R", "2"]}], ")"}]}], "-", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"k", " ", "n0"}], "-", "omegam"}], ")"}], 
                   "2"]}]]}], "-", "omegam"}], ")"}], " ", "x"}]}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k", " ", "n0"}], "+", 
            RowBox[{"\[ImaginaryI]", " ", 
             SqrtBox[
              RowBox[{
               RowBox[{
                RowBox[{"-", "4"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["g0I", "2"], "+", 
                  SuperscriptBox["g0R", "2"]}], ")"}]}], "-", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"k", " ", "n0"}], "-", "omegam"}], ")"}], "2"]}]]}],
             "-", "omegam"}], ")"}], " ", 
          RowBox[{"C", "[", "1", "]"}]}]}], "+", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"g0I", "-", 
             RowBox[{"\[ImaginaryI]", " ", "g0R"}]}], ")"}]}]], 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SqrtBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "4"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["g0I", "2"], "+", 
                    SuperscriptBox["g0R", "2"]}], ")"}]}], "-", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"k", " ", "n0"}], "-", "omegam"}], ")"}], "2"]}]],
                "+", 
               RowBox[{"\[ImaginaryI]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"k", " ", "n0"}], "-", "omegam"}], ")"}]}]}], ")"}],
              " ", "x"}], "-", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"k", " ", "n0"}], "-", "omegam"}], ")"}], " ", 
             "x"}]}]], " ", 
          RowBox[{"(", 
           RowBox[{
            SqrtBox[
             RowBox[{
              RowBox[{
               RowBox[{"-", "4"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["g0I", "2"], "+", 
                 SuperscriptBox["g0R", "2"]}], ")"}]}], "-", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"k", " ", "n0"}], "-", "omegam"}], ")"}], "2"]}]], 
            "+", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"k", " ", "n0"}], "-", "omegam"}], ")"}]}]}], ")"}], 
          " ", 
          RowBox[{"C", "[", "2", "]"}]}]}]}]}], "]"}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.662964167608943*^9, 3.663434426862656*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Understand The Hamiltonian", "Section",
 CellChangeTimes->{{3.6635192732550573`*^9, 3.663519280843937*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"k", ",", "x", ",", "phi", ",", "function1", ",", "constant1"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DSolve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"I", " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"function1", "[", "x", "]"}], ",", "x"}], "]"}]}], "\[Equal]", 
     RowBox[{"constant1", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"k", " ", "x"}], "+", "phi"}], "]"}], 
      RowBox[{"function1", "[", "x", "]"}]}]}], ",", "function1", ",", "x"}], 
   "]"}], "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.663519296161235*^9, 3.66351938583416*^9}, {
   3.6635194374982853`*^9, 3.6635194398905354`*^9}, 3.663527445234469*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"function1", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "x", "}"}], ",", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "constant1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{
              RowBox[{"Cos", "[", "phi", "]"}], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"k", " ", "x"}], "]"}]}], "k"]}], "+", 
           FractionBox[
            RowBox[{
             RowBox[{"Sin", "[", "phi", "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"k", " ", "x"}], "]"}]}], "k"]}], ")"}]}]], " ", 
       RowBox[{"C", "[", "1", "]"}]}]}], "]"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.663519387444941*^9, 3.663519440494726*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "a", ",", "k", ",", "x", ",", "phi", ",", "function1", ",", "constant1"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"function1", "[", "x", "]"}], ",", "x"}], "]"}], ",", "x"}], 
      "]"}], "-", 
     RowBox[{
      FractionBox[
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"a", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"k", " ", "x"}], " ", "+", " ", "phi"}], "]"}]}], ",", 
         "x"}], "]"}], 
       RowBox[{"a", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"k", " ", "x"}], " ", "+", " ", "phi"}], "]"}]}]], 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"function1", "[", "x", "]"}], ",", "x"}], "]"}]}]}], 
    "\[Equal]", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"2", "thetam"}], "]"}], "^", "2"}], "4"]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"k", " ", "x"}], " ", "+", " ", "phi"}], "]"}]}], ")"}], 
      "^", "2"}], " ", 
     RowBox[{"function1", "[", "x", "]"}]}]}], ",", "function1", ",", "x"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.663527432069776*^9, 3.663527579597537*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"function1", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "x", "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"C", "[", "1", "]"}], " ", 
        RowBox[{"Cos", "[", 
         FractionBox[
          RowBox[{"a", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"phi", "+", 
             RowBox[{"k", " ", "x"}]}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", "thetam"}], "]"}]}], 
          RowBox[{"2", " ", "k"}]], "]"}]}], "-", 
       RowBox[{
        RowBox[{"C", "[", "2", "]"}], " ", 
        RowBox[{"Sin", "[", 
         FractionBox[
          RowBox[{"a", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"phi", "+", 
             RowBox[{"k", " ", "x"}]}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", "thetam"}], "]"}]}], 
          RowBox[{"2", " ", "k"}]], "]"}]}]}]}], "]"}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6635275804118013`*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1101, 655},
WindowMargins->{{-1373, Automatic}, {Automatic, -111}},
Magnification:>1.25 Inherited,
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (December 4, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1392, 42, 57, "Input"],
Cell[1975, 66, 1227, 37, 78, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3239, 108, 123, 3, 36, "Input"],
Cell[3365, 113, 1333, 38, 91, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4735, 156, 606, 18, 36, "Input"],
Cell[5344, 176, 769, 24, 63, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6150, 205, 1609, 49, 78, "Input"],
Cell[7762, 256, 1242, 37, 42, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9041, 298, 266, 6, 36, "Input"],
Cell[9310, 306, 6150, 171, 333, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15497, 482, 127, 2, 36, "Input"],
Cell[15627, 486, 6150, 171, 333, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21814, 662, 113, 1, 80, "Section"],
Cell[CellGroupData[{
Cell[21952, 667, 751, 19, 78, "Input"],
Cell[22706, 688, 909, 25, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23652, 718, 1459, 47, 132, "Input"],
Cell[25114, 767, 1041, 31, 148, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
